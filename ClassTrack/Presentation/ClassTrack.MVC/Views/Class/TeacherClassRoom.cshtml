@model GetClassRoomWithPermissionVM


<link rel="stylesheet" href="~/css/class.css">

<div class="topbar">
    <div class="topbar-left">
        <div class="h1" id="classTitle">@Model.ClassRoom.Name</div>
        <div class="muted">
            Role: <span class="badge teacher" id="roleBadge">Teacher</span>
        </div>
    </div>

    <div class="topbar-right">
        <div class="nav-actions">
            <a class="btn primary" id="btnCreateQuiz"
               asp-controller="Quiz" asp-action="Create" asp-route-id="@Model.ClassRoom.Id">
                + Create Quiz
            </a>

            <a class="btn ok" id="btnCreateTask"
               asp-controller="TaskWork" asp-action="Post" asp-route-classRoomId="@Model.ClassRoom.Id">
                + Create Task
            </a>
        </div>
    </div>
</div>


<div class="row">
    <div class="card col2">
        <div class="h2">Class Info</div>
        <div class="kv">
            <div class="k">Class Code</div>
            <div class="v"><span id="classCode">@Model.ClassRoom.PrivateKey</span></div>

            <div class="k">Members</div>
            <div class="v"><span id="memberCount">@Model.ClassRoom.MemberCount</span></div>
        </div>
    </div>

    <div class="card col1">
        <div class="h2">Tabs</div>
        <div class="tabs">
            <a class="tab active" asp-controller="Quiz" asp-action="Index" asp-route-id="@Model.ClassRoom.Id" data-tab="quizzes">Quizzes</a>
            <a class="tab" data-tab="tasks">Tasks</a>
            <a class="tab active" data-tab="attendance" asp-controller="Attendance" asp-action="Attendance" asp-route-classRoomId="@Model.ClassRoom.Id">Attendance</a>
            <a class="tab active" asp-controller="Member" asp-action="Members" asp-route-classRoomId="@Model.ClassRoom.Id">Members</a>
        </div>
    </div>
</div>

<div class="card" style="margin-top:16px;width:fit-content">
    <div class="nav-actions danger-actions" style="display:flex;justify-content:end">
        <a class="btn" id="btnToggleRename" type="button">
            Edit name
        </a>


        <a class="btn danger" id="btnCreateTask"
           asp-action="DeleteClassRoom" asp-route-id="@Context.GetRouteValue("id")" type="button">
            Delete Class
        </a>
    </div>
   

    <div class="card" id="renameBox"
         style="margin-top:12px; max-width:520px; display:none;">

        <div class="h2">Quick rename</div>
        <div class="muted" style="margin-top:4px">
            Sadəcə adı dəyiş və save elə.
        </div>

        <div class="line" style="margin:12px 0"></div>

        <form class="row-inline" asp-action="Update" 
                                 asp-route-id="@Context.GetRouteValue("id")"                                  
                                 style="gap:10px; align-items:end;">
           
            
            <div style="flex:1;margin-bottom:10px">
                <div class="label">Class name</div>
                <input class="input"
                       asp-for="PutClassRoom.Name"
                       placeholder="Yeni ad..."
                       required />
            </div>

            <button class="btn ok" >Save</button>
        </form>
    </div>
</div>

<script defer src="~/js/class.js"></script>
<script>
    const btn = document.getElementById("btnToggleRename");
    const box = document.getElementById("renameBox");
    const input = box.querySelector('input[name="Name"]');

    btn.addEventListener("click", () => {
      const opened = box.style.display === "block";

      box.style.display = opened ? "none" : "block";
      btn.textContent = opened ? "Edit name" : "Cancel";

      if (!opened) {
        setTimeout(() => input.focus(), 50);
      }
    });
</script>